<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:NewtService.Tray.ViewModels"
        xmlns:conv="using:NewtService.Tray.Converters"
        x:Class="NewtService.Tray.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Newt VPN"
        Width="480"
        Height="370"
        WindowStartupLocation="CenterScreen"
        CanResize="False"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="PreferSystemChrome"
        Background="#1a1a2e">

    <Window.Resources>
        <conv:StatusColorConverter x:Key="StatusColorConverter"/>
    </Window.Resources>

    <Window.Styles>
        <Style Selector="TextBlock.header">
            <Setter Property="FontSize" Value="22"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#ffffff"/>
        </Style>
        <Style Selector="TextBlock.subheader">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#8b8b9a"/>
        </Style>
        <Style Selector="TextBlock.label">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#8b8b9a"/>
            <Setter Property="Margin" Value="0,8,0,4"/>
        </Style>
        <Style Selector="TextBox">
            <Setter Property="Background" Value="#252542"/>
            <Setter Property="BorderBrush" Value="#3d3d5c"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        <Style Selector="TextBox:focus /template/ Border">
            <Setter Property="BorderBrush" Value="#4CAF50"/>
        </Style>
        <Style Selector="Button.primary">
            <Setter Property="Background" Value="#4CAF50"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>
        <Style Selector="Button.primary:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#66BB6A"/>
        </Style>
        <Style Selector="Button.secondary">
            <Setter Property="Background" Value="#252542"/>
            <Setter Property="Foreground" Value="#b0b0c0"/>
            <Setter Property="BorderBrush" Value="#3d3d5c"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>
        <Style Selector="Button.update">
            <Setter Property="Background" Value="#1976D2"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>
        <Style Selector="Button.update:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#1E88E5"/>
        </Style>
        <Style Selector="Button.link">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#4a4a5a"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="10"/>
        </Style>
        <Style Selector="Button.link:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#6a6a7a"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="*,Auto,Auto" Margin="20,32,20,12">
        <StackPanel Grid.Row="0" Spacing="0">
            
            <!-- Header -->
            <StackPanel Spacing="2" Margin="0,0,0,6">
                <TextBlock Classes="header" Text="Newt VPN"/>
                <StackPanel Orientation="Horizontal" Spacing="4">
                    <TextBlock Classes="subheader" Text="Status: "/>
                    <TextBlock Classes="subheader" Text="{Binding Status}" 
                               Foreground="{Binding IsRunning, Converter={StaticResource StatusColorConverter}}"/>
                    <TextBlock Classes="subheader" Text=" • "/>
                    <TextBlock Classes="subheader" Text="{Binding Version}"/>
                </StackPanel>
            </StackPanel>

            <!-- Form -->
            <TextBlock Classes="label" Text="ENDPOINT" Margin="0,0,0,4"/>
            <TextBox Text="{Binding Endpoint}" Watermark="https://app.pangolin.net"/>
            
            <TextBlock Classes="label" Text="ID"/>
            <TextBox Text="{Binding ClientId}" Watermark="Your client ID"/>
            
            <TextBlock Classes="label" Text="SECRET"/>
            <TextBox Text="{Binding Secret}" PasswordChar="•" Watermark="Your client secret"/>
        </StackPanel>

        <!-- All Buttons Row -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="6" Margin="0,14,0,0" HorizontalAlignment="Center">
            <Button Classes="secondary" Content="Check Service" Command="{Binding CheckServiceCommand}"/>
            <Button Classes="update" Content="{Binding UpdateButtonText}" Command="{Binding CheckUpdateCommand}"/>
            <Button Classes="primary" Content="Start" Command="{Binding StartCommand}" 
                    IsVisible="{Binding !IsRunning}" IsEnabled="{Binding IsInstalled}"/>
            <Button Classes="secondary" Content="Stop" Command="{Binding StopCommand}" 
                    IsVisible="{Binding IsRunning}"/>
            <Button Classes="secondary" Content="Restart" Command="{Binding RestartCommand}" 
                    IsVisible="{Binding IsRunning}"/>
            <Button Classes="primary" Content="Save" Command="{Binding SaveConfigCommand}"/>
        </StackPanel>

        <!-- Footer -->
        <Button Grid.Row="2" Classes="link" Content="NewtService" Margin="0,10,0,0"
                Command="{Binding OpenGitHubCommand}" HorizontalAlignment="Center"/>
    </Grid>
</Window>
