<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:NewtService.Tray.ViewModels"
        xmlns:conv="using:NewtService.Tray.Converters"
        x:Class="NewtService.Tray.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Newt VPN"
        Width="460"
        Height="420"
        WindowStartupLocation="CenterScreen"
        CanResize="False"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="PreferSystemChrome"
        Background="#1a1a2e">

    <Window.Resources>
        <conv:StatusColorConverter x:Key="StatusColorConverter"/>
    </Window.Resources>

    <Window.Styles>
        <Style Selector="TextBlock.header">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#ffffff"/>
        </Style>
        <Style Selector="TextBlock.subheader">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#8b8b9a"/>
        </Style>
        <Style Selector="TextBlock.label">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#b0b0c0"/>
            <Setter Property="Margin" Value="0,16,0,6"/>
        </Style>
        <Style Selector="TextBox">
            <Setter Property="Background" Value="#252542"/>
            <Setter Property="BorderBrush" Value="#3d3d5c"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="14,12"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        <Style Selector="TextBox:focus /template/ Border">
            <Setter Property="BorderBrush" Value="#4CAF50"/>
        </Style>
        <Style Selector="Button.primary">
            <Setter Property="Background" Value="#4CAF50"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="24,12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
        <Style Selector="Button.primary:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#66BB6A"/>
        </Style>
        <Style Selector="Button.secondary">
            <Setter Property="Background" Value="#252542"/>
            <Setter Property="Foreground" Value="#b0b0c0"/>
            <Setter Property="BorderBrush" Value="#3d3d5c"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,*,Auto">
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#16162a" Padding="28,36,28,24">
            <StackPanel Spacing="6">
                <TextBlock Classes="header" Text="Newt VPN"/>
                <StackPanel Orientation="Horizontal" Spacing="4">
                    <TextBlock Classes="subheader" Text="Status: "/>
                    <TextBlock Classes="subheader" Text="{Binding Status}" 
                               Foreground="{Binding IsRunning, Converter={StaticResource StatusColorConverter}}"/>
                    <TextBlock Classes="subheader" Text=" • "/>
                    <TextBlock Classes="subheader" Text="{Binding Version}"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" Padding="28,8,28,0">
            <StackPanel>
                <TextBlock Classes="label" Text="ENDPOINT"/>
                <TextBox Text="{Binding Endpoint}" Watermark="https://app.pangolin.net"/>
                
                <TextBlock Classes="label" Text="ID"/>
                <TextBox Text="{Binding ClientId}" Watermark="Your client ID"/>
                
                <TextBlock Classes="label" Text="SECRET"/>
                <TextBox Text="{Binding Secret}" PasswordChar="•" Watermark="Your client secret"
                         RevealPassword="{Binding ShowSecret}"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2" Padding="28,20,28,28">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10">
                    <Button Classes="primary" Content="Start" Command="{Binding StartCommand}" 
                            IsVisible="{Binding !IsRunning}" IsEnabled="{Binding IsInstalled}"/>
                    <Button Classes="secondary" Content="Stop" Command="{Binding StopCommand}" 
                            IsVisible="{Binding IsRunning}"/>
                    <Button Classes="secondary" Content="Restart" Command="{Binding RestartCommand}" 
                            IsVisible="{Binding IsRunning}"/>
                </StackPanel>
                <Button Grid.Column="1" Classes="primary" Content="Save" Command="{Binding SaveConfigCommand}"/>
            </Grid>
        </Border>
    </Grid>
</Window>
